import{d as le,p as ie,j as l,a8 as se,E as re,k as x,_ as de,o as ue,e as me,a as r,w as g,H as ge,a2 as ce,I as _,g as O,h as z}from"./index-C5K_s1wl.js";import{B as pe}from"./BaseBreadcrumb-DEdlJy1-.js";import{E as fe}from"./EventForm-Bv582PYY.js";import{u as be,a as ye}from"./useNetwork-BBZmMd-V.js";import{f as ve}from"./utils-CFlAkpuO.js";import{u as Fe}from"./useCommonCode-DIzdSdac.js";import"./PeriodDate-Y1bD6Y6f.js";import"./format-CimBkJP1.js";import"./LandingSelect-DityfkCS.js";import"./common-AUcBvRqL.js";const De=le({__name:"ABOR2100",setup(M,{expose:a}){a(),ie(()=>{V()});const q=l({title:"이벤트 상세"}),e=l([{text:"Dashboard (Home)",disabled:!1,href:"/admin/dashboard"},{text:"게시판 관리",disabled:!1,href:"/admin/events"},{text:"이벤트",disabled:!1,href:"/admin/events"},{text:"이벤트 상세",disabled:!0,href:"#"}]),c=be(),y=se(),t=re(),{confirm:N,alert:p}=ye(),{getLandingOptions:j}=Fe(),T=l([]),V=async()=>{T.value=await j()},f=x({type:null,value:null}),v=l(),b=l(!1),w=l(""),E=l(""),S=l(null),H=l(null),L=l(null),J=l(null),F=l(""),D=l(""),h=l(null),k=l(""),R=l(""),I=l(null),B=l(null),W=l(""),G=l(!1),C=l(""),P=l(null),K=l(""),Q=l(""),u=x({files:[],deleteFiles:[]}),m=x({files:[],deleteFiles:[]}),$=async()=>{var d;const{status:s,data:n}=await c.post({url:"/board/eventboard/detail",body:{headDocId:String(y.params.docId)}});s&&(E.value=n.headDocId,w.value=n.bodyDocId,F.value=n.title,D.value=n.eventBoardBodyDocs.contents,S.value=n.subCategoryId??null,H.value=n.subCategoryName??null,L.value=n.parentCategoryId??null,J.value=n.parentCategoryName??null,h.value=n.displayFlag??null,k.value=n.pinFlag,R.value=n.pubAlwaysFlag,I.value=n.pubStartDate??null,B.value=n.pubEndDate??null,W.value=n.attachFlag,C.value=n.eventBoardBodyDocs.cautionMatter,P.value=n.eventBoardBodyDocs.btnName??null,K.value=n.eventBoardBodyDocs.btnLinkType,Q.value=n.eventBoardBodyDocs.btnLinkLocation,(d=v.value)==null||d.initCategory(),m.files=n.imageFiles.map(i=>({attachId:i.attachId,fileName:i.fileName,filePath:i.filePath,orderNo:i.orderNo,fileSize:i.fileSize??null})),u.files=Array.isArray(n.eventBoardBodyDocs.imageFiles)?n.eventBoardBodyDocs.imageFiles.map(i=>({attachId:i.attachId,fileName:i.fileName,filePath:i.filePath,orderNo:i.orderNo,fileSize:i.fileSize??null})):[],C.value=n.eventBoardBodyDocs.cautionMatter,f.type=n.eventBoardBodyDocs.btnLinkType,f.value=n.eventBoardBodyDocs.btnLinkLocation)},ee=async()=>{const{role:s}=await N("삭제하시겠습니까?","삭제","취소");if(s!="confirm")return;b.value=!0;const{status:n}=await c.post({url:"/board/eventboard/delete",isLoading:!0,body:{headDocId:String(y.params.docId)}});b.value=!1,n&&t.push("/events")};function A(s){if(!s)return null;const n=new Date(s);return ve(n,"yyyy-MM-DDTHH:mm:ss")}const X={page:q,breadcrumbs:e,network:c,route:y,router:t,confirm:N,alert:p,getLandingOptions:j,landingLocationOpts:T,getlandingLocationOpts:V,landing:f,eventFormRef:v,loading:b,bodyDocId:w,headDocId:E,subCategoryId:S,categoryName:H,parentCategoryId:L,parentCategoryName:J,title:F,contents:D,displayFlag:h,pinFlag:k,pubAlwaysFlag:R,pubStartDate:I,pubEndDate:B,attachFlag:W,selectedPeriod:G,cautionMatter:C,btnName:P,btnLinkType:K,btnLinkLocation:Q,imageFiles:u,imageFileBanner:m,fetchEventDetails:$,deleteEvent:ee,formatToISO:A,saveEvent:async()=>{var Y,Z;const{role:s}=await N("정말로 이 항목을 저장하시겠습니까?","저장","취소");if(s!=="confirm")return;if(!F.value)return p("제목을 입력해주세요."),!1;if(!I.value||!B.value&&!G.value)return p("시작일과 마감일을 선택해주세요."),!1;if(m.files.length<=0)return p("목록 배너를 등록해주세요."),!1;if(u.files.length<=0&&!D.value)return p("이미지 파일 등록 혹은 이벤트 내용을 입력해주세요"),!1;const n={parent:(Y=v.value)!=null&&Y.isCategoryNotExist().category?null:L.value,sub:(Z=v.value)!=null&&Z.isCategoryNotExist().subCategory?null:S.value};b.value=!0;const d=new FormData,i={headDocId:E.value,title:F.value,imageFiles:m.files.map((o,U)=>({attachId:o.attachId||"",fileName:o.fileName||o.name,filePath:o.filePath||"",orderNo:U+1,fileSize:o.fileSize||o.size})),parentCategoryId:n.parent||null,subCategoryId:n.sub||null,displayFlag:h.value,pinFlag:k.value,pubAlwaysFlag:R.value,pubStartDate:A(I.value),pubEndDate:A(B.value),deleteImageFileIds:m.deleteFiles.map(o=>o.attachId)},ae={bodyDocId:w.value,headDocId:i.headDocId,contents:D.value,imageFiles:u.files.map((o,U)=>({attachId:o.attachId||"",fileName:o.fileName||o.name,filePath:o.filePath||"",orderNo:U+1,fileSize:o.fileSize||o.size})),cautionMatter:C.value,btnName:P.value||"",btnLinkType:f.type,btnLinkLocation:f.value??"",deleteImageFileIds:u.deleteFiles.map(o=>o.attachId)},te=new Blob([JSON.stringify(i)],{type:"application/json"});d.append("headRequest",te,"headRequest.json");const ne=new Blob([JSON.stringify(ae)],{type:"application/json"});d.append("bodyRequest",ne,"bodyRequest.json"),[...m.files.filter(o=>o instanceof File),...u.files.filter(o=>o instanceof File)].forEach(o=>{d.append("newImageFiles",o,o.name)});const{status:oe}=await c.post({url:"/board/eventboard/update",isLoading:!0,body:d});b.value=!1,oe&&t.push("/events")},BaseBreadcrumb:pe,EventForm:fe};return Object.defineProperty(X,"__isScriptSetup",{enumerable:!1,value:!0}),X}});function Ie(M,a,q,e,c,y){return ue(),me(ce,null,[r(e.BaseBreadcrumb,{title:e.page.title,breadcrumbs:e.breadcrumbs},null,8,["title","breadcrumbs"]),r(ge,null,{default:g(()=>[r(_,{cols:"12"},{default:g(()=>[r(e.EventForm,{isForDetails:!0,selectedPeriod:e.selectedPeriod,"onUpdate:selectedPeriod":a[0]||(a[0]=t=>e.selectedPeriod=t),pinFlag:e.pinFlag,"onUpdate:pinFlag":a[1]||(a[1]=t=>e.pinFlag=t),pubStartDate:e.pubStartDate,"onUpdate:pubStartDate":a[2]||(a[2]=t=>e.pubStartDate=t),pubEndDate:e.pubEndDate,"onUpdate:pubEndDate":a[3]||(a[3]=t=>e.pubEndDate=t),note:e.cautionMatter,"onUpdate:note":a[4]||(a[4]=t=>e.cautionMatter=t),btnName:e.btnName,"onUpdate:btnName":a[5]||(a[5]=t=>e.btnName=t),parentCategoryId:e.parentCategoryId,"onUpdate:parentCategoryId":a[6]||(a[6]=t=>e.parentCategoryId=t),subCategoryId:e.subCategoryId,"onUpdate:subCategoryId":a[7]||(a[7]=t=>e.subCategoryId=t),title:e.title,"onUpdate:title":a[8]||(a[8]=t=>e.title=t),imageFileBanner:e.imageFileBanner,"onUpdate:imageFileBanner":a[9]||(a[9]=t=>e.imageFileBanner=t),contents:e.contents,"onUpdate:contents":a[10]||(a[10]=t=>e.contents=t),displayFlag:e.displayFlag,"onUpdate:displayFlag":a[11]||(a[11]=t=>e.displayFlag=t),imageFiles:e.imageFiles,"onUpdate:imageFiles":a[12]||(a[12]=t=>e.imageFiles=t),postId:e.headDocId,"landing-location-opts":e.landingLocationOpts,landing:e.landing,"onUpdate:landing":a[13]||(a[13]=t=>e.landing=t),onAfterInit:e.fetchEventDetails,ref:"eventFormRef"},null,8,["selectedPeriod","pinFlag","pubStartDate","pubEndDate","note","btnName","parentCategoryId","subCategoryId","title","imageFileBanner","contents","displayFlag","imageFiles","postId","landing-location-opts","landing"])]),_:1}),r(_,{cols:"12",class:"d-flex justify-space-between"},{default:g(()=>[r(O,{flat:"",color:"error",onClick:a[14]||(a[14]=t=>e.deleteEvent())},{default:g(()=>[z("삭제")]),_:1}),r(O,{flat:"",color:"grey100",onClick:a[15]||(a[15]=t=>M.$router.push("/events"))},{default:g(()=>[z("목록 이동")]),_:1}),r(O,{flat:"",color:"grey200",onClick:a[16]||(a[16]=t=>e.saveEvent())},{default:g(()=>[z("저장")]),_:1})]),_:1})]),_:1})],64)}const Ue=de(De,[["render",Ie],["__file","C:/workspace/hiplusWEB/smhiplus-mobile-admin-front/src/views/ABOR/ABOR2100.vue"]]);export{Ue as default};
