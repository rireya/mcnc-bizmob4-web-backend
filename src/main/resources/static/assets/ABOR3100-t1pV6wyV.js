import{d as X,a8 as Y,E as Z,j as s,k as $,p as ee,_ as ae,o as te,e as ne,a as u,w as g,H as le,a2 as oe,I as _,g as R,h as S}from"./index-C5K_s1wl.js";import{B as se}from"./BaseBreadcrumb-DEdlJy1-.js";import{C as ie}from"./ContentForm-C-ZrhGrn.js";import{u as re,a as de}from"./useNetwork-BBZmMd-V.js";import{u as ue}from"./useCommonCode-DIzdSdac.js";import"./utils-CFlAkpuO.js";import"./common-AUcBvRqL.js";import"./LandingSelect-DityfkCS.js";const ce=X({__name:"ABOR3100",setup(A,{expose:n}){n();const p=re(),a=Y(),y=Z(),{confirm:I}=de(),{getLandingOptions:l}=ue(),j=s({title:"하이패스 인포 상세"}),V=s([{text:"Dashboard (Home)",disabled:!1,href:"/admin/dashboard"},{text:"게시판 관리",disabled:!1,href:"/admin/contents"},{text:"하이패스 인포",disabled:!1,href:"/admin/contents"},{text:"하이패스 인포 상세",disabled:!0,href:"#"}]),F=s(),C=s(null),N=s(null),b=s(""),D=s(""),h=s(""),x=s(""),k=s(null),c=$({files:[],deleteFiles:[]}),L=s([]),O=async()=>{L.value=await l()},f=s([{metaDocId:"",contents:"",orderNo:1,imageFiles:{},linkLabel:"",linkType:"",linkValue:"",createDate:"",createBy:"",bodyDocId:"",linkUrl:"",landing:{type:null,value:null},deleteFlag:""}]),m=s(!1),E=async()=>{var w;const{status:B,data:o}=await p.post({url:"/board/hipassinfo/detail",body:{hipassInfoDocId:String(a.params.docId)}});B&&(D.value=o.docId,b.value=o.title,x.value=o.contents,C.value=o.parentCategoryId??null,N.value=o.subCategoryId??null,k.value=o.displayFlag??null,h.value=o.pinFlag,(w=F.value)==null||w.initCategory(),f.value.splice(0,f.value.length,...o.hipassInfoBodyDocs.map(t=>({createDate:t.createDate,createBy:t.createBy,updateDate:t.updateDate,updateBy:t.updateBy,bodyDocId:t.bodyDocId,metaDocId:t.metaDocId,orderNo:t.orderNo,contents:t.contents,linkLabel:t.linkLabel,linkUrl:t.linkUrl,linkType:t.linkType,deleteFlag:t.deleteFlag,landing:{value:t.linkUrl,type:t.linkType},imageFiles:{files:Array.isArray(t.imageFiles)?t.imageFiles.map(r=>({attachId:r.attachId,fileName:r.fileName,filePath:r.filePath,orderNo:r.orderNo,fileSize:r.fileSize})):[],deleteFiles:[]}}))),c.files=Array.isArray(o.imageFiles)?o.imageFiles.map(t=>({attachId:t.attachId,fileName:t.fileName,filePath:t.filePath,orderNo:t.orderNo,fileSize:t.fileSize})):[],c.deleteFiles=[])},T=async()=>{const{role:B}=await I("삭제하시겠습니까?","삭제","취소");if(B!="confirm")return;m.value=!0;const{status:o}=await p.post({url:"/board/hipassinfo/delete",isLoading:!0,body:{metaDocId:String(a.params.docId)}});m.value=!1,o&&y.push("/contents")},J=async(B=!1)=>{var q,z,P;const{role:o}=await I("정말로 이 항목을 저장하시겠습니까?","저장","취소");if(o!="confirm")return;if(!C.value)return alert("카테고리를 선택해주세요."),!1;if(!b.value)return alert("제목을 입력해주세요."),!1;if(c.files.length<=0)return alert("목록 배너를 등록해주세요."),!1;if(!f.value.every(e=>e.imageFiles.files.every(i=>i.filePath!=="")))return alert("이미지 파일을 등록해주세요."),!1;if(!f.value.every(e=>e.contents!==""))return alert("본문글을 작성해주세요."),!1;const r={parent:(q=F.value)!=null&&q.isCategoryNotExist().category?null:C.value,sub:(z=F.value)!=null&&z.isCategoryNotExist().subCategory?null:N.value};m.value=!0;const v=new FormData,M={metaDocId:D.value,title:b.value,parentCategoryId:r.parent,subCategoryId:r.sub,displayFlag:k.value,pinFlag:h.value,deleteImageFileIds:((P=c.deleteFiles)==null?void 0:P.map(e=>e.attachId))||[],imageFiles:c.files.map((e,i)=>({attachId:e.attachId||"",fileName:e.fileName||e.name,filePath:e.filePath||"",orderNo:i+1,fileSize:e.fileSize||e.size}))},H=f.value.map(e=>{var i;return{bodyDocId:e.bodyDocId,metaDocId:e.metaDocId,contents:e.contents||"",orderNo:e.orderNo,imageFiles:e.imageFiles.files.map((d,Q)=>({attachId:d.attachId||"",fileName:d.fileName||d.name,filePath:d.filePath||"",orderNo:Q+1,fileSize:d.fileSize||d.size})),linkLabel:e.linkLabel||"",linkType:e.landing.type||"",linkValue:e.landing.value||"",deleteFlag:e.deleteFlag||"N",deleteImageFileIds:((i=e.imageFiles.deleteFiles)==null?void 0:i.map(d=>d.attachId))||[]}}),W=new Blob([JSON.stringify(M)],{type:"application/json"});v.append("metaRequest",W,"metaRequest.json");const G=new Blob([JSON.stringify(H)],{type:"application/json"});v.append("bodyRequests",G,"bodyRequests.json"),[...c.files.filter(e=>e instanceof File),...f.value.flatMap(e=>{var i;return((i=e.imageFiles)==null?void 0:i.files)||[]}).filter(e=>e instanceof File)].forEach(e=>{v.append("newImageFiles",e,e.name)});const{status:K}=await p.post({url:"/board/hipassinfo/update",isLoading:!0,body:v});m.value=!1,K&&y.push("/contents")};ee(()=>{O()});const U={network:p,route:a,router:y,confirm:I,getLandingOptions:l,page:j,breadcrumbs:V,contentFormRef:F,parentCategoryId:C,subCategoryId:N,title:b,docId:D,pinFlag:h,contents:x,displayFlag:k,imageFilesBanner:c,landingLocationOpts:L,getlandingLocationOpts:O,contentBlocks:f,loading:m,reqContentDetails:E,deleteContent:T,saveContent:J,BaseBreadcrumb:se,ContentForm:ie};return Object.defineProperty(U,"__isScriptSetup",{enumerable:!1,value:!0}),U}});function fe(A,n,p,a,y,I){return te(),ne(oe,null,[u(a.BaseBreadcrumb,{title:a.page.title,breadcrumbs:a.breadcrumbs},null,8,["title","breadcrumbs"]),u(le,null,{default:g(()=>[u(_,{cols:"12"},{default:g(()=>[u(a.ContentForm,{isForDetails:!1,pinFlag:a.pinFlag,"onUpdate:pinFlag":n[0]||(n[0]=l=>a.pinFlag=l),parentCategoryId:a.parentCategoryId,"onUpdate:parentCategoryId":n[1]||(n[1]=l=>a.parentCategoryId=l),subCategoryId:a.subCategoryId,"onUpdate:subCategoryId":n[2]||(n[2]=l=>a.subCategoryId=l),title:a.title,"onUpdate:title":n[3]||(n[3]=l=>a.title=l),contentBlocks:a.contentBlocks,"onUpdate:contentBlocks":n[4]||(n[4]=l=>a.contentBlocks=l),displayFlag:a.displayFlag,"onUpdate:displayFlag":n[5]||(n[5]=l=>a.displayFlag=l),fileBanner:a.imageFilesBanner,"onUpdate:fileBanner":n[6]||(n[6]=l=>a.imageFilesBanner=l),docId:a.docId,"landing-location-opts":a.landingLocationOpts,onAfterInit:a.reqContentDetails,ref:"contentFormRef"},null,8,["pinFlag","parentCategoryId","subCategoryId","title","contentBlocks","displayFlag","fileBanner","docId","landing-location-opts"])]),_:1}),u(_,{cols:"12",class:"d-flex justify-space-between"},{default:g(()=>[u(R,{flat:"",color:"error",onClick:a.deleteContent},{default:g(()=>[S("삭제")]),_:1}),u(R,{flat:"",color:"grey100",onClick:n[7]||(n[7]=l=>A.$router.push("/contents"))},{default:g(()=>[S("목록 이동")]),_:1}),u(R,{flat:"",color:"grey200",onClick:n[8]||(n[8]=l=>a.saveContent())},{default:g(()=>[S("저장")]),_:1})]),_:1})]),_:1})],64)}const ve=ae(ce,[["render",fe],["__file","C:/workspace/hiplusWEB/smhiplus-mobile-admin-front/src/views/ABOR/ABOR3100.vue"]]);export{ve as default};
