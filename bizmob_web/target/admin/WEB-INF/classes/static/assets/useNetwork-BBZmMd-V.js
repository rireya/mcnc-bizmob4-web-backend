var G=Object.defineProperty;var D=(d,e,r)=>e in d?G(d,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[e]=r;var j=(d,e,r)=>D(d,typeof e!="symbol"?e+"":e,r);import{aJ as A,aK as R,aL as L,as as P,k as W,aM as $}from"./index-C5K_s1wl.js";const _=class _{static getGlobalInstance(){return _.globalInstance||(_.globalInstance=new _),_.globalInstance}createLoading(e){return new Promise(r=>{A.isReady?r(new A(e)):A.onReady(()=>r(new A(e)))})}dismissLoading(e){A.hooks.dismissLoading(e)}createAlert(e){return new Promise(r=>{R.isReady?r(new R(e)):R.onReady(()=>r(new R(e)))})}dismissAlert(e,r,t){R.hooks.dismissAlert(e,r,t)}createConfirm(e){return new Promise(r=>{L.isReady?r(new L(e)):L.onReady(()=>r(new L(e)))})}dismissConfirm(e,r,t){L.hooks.dismissConfirm(e,r,t)}createModal(e){return new Promise(r=>{P.isReady?r(new P(e)):P.onReady(()=>r(new P(e)))})}dismissModal(e,r,t){P.hooks.dismissModal(e,r,t)}};j(_,"globalInstance");let U=_;function z(){return U.getGlobalInstance()}function H(){const d=z(),e=()=>({cancel:"취소",ok:"확인"});return{alert:async(r,t,T)=>{const y=await d.createAlert({content:r,title:T,btnText:t??e().ok});y.present(),await y.onUnmounted()},confirm:async(r,t,T)=>{const y=await d.createConfirm({content:r,actionButton:[{text:T??e().cancel,role:"cancel"},{text:t??e().ok,role:"confirm"}]});return y.present(),{role:(await y.onUnmounted()).role}}}}const S=window.bizMOB;class q{static changeLocale(e){return new Promise(r=>{S.Network.changeLocale({...e,_fCallback:t=>r(t)})})}static requestLogin(e){return new Promise(r=>{S.Network.requestLogin({...e,_fCallback:function(t){r(t)}})})}static requestTr(e){return new Promise(r=>{S.Network.requestTr({...e,_fCallback:function(t){r(t)}})})}static requestHttp(e){return new Promise(r=>{S.Network.requestHttp({...e,_fCallback:function(t){r(t)}})})}static requestApi(e){return new Promise(r=>{S.Http.request({...e,_fCallback:function(t){r(t)}})})}}const E=window.bizMOB;class v{static callPlugIn(e,r){return new Promise(t=>{E.App.callPlugIn(e,{...r,callback:function(T){t(T)}})})}static exit(e){return new Promise(r=>{E.App.exit({...e,_fCallback:function(t){r(t)}})})}static getTimeout(e){return new Promise(r=>{E.App.setTimeout({...e,_fCallback:function(t){r(t)}})})}static setTimeout(e){return new Promise(r=>{E.App.setTimeout({...e,_fCallback:function(t){r(t)}})})}static hideSplash(){return new Promise(e=>{E.App.hideSplash({_fCallback:function(r){e(r)}})})}}const p=W({loading:0});function I(){const d=z();return{showLoading:async e=>(e||(e="Loading_"+Math.floor(Date.now()*Math.random())),p.loading+=1,p.loading<2&&await(await d.createLoading({id:e})).present(),e),removeLoading:()=>{p.loading>0&&(p.loading-=1,p.loading<=0&&d.dismissLoading())},removeLoadingById:e=>{p.loading>0&&(p.loading-=1),d.dismissLoading(e)},distroyLoading:()=>{p.loading=0,d.dismissLoading()}}}function V(){function d(o){if(typeof o!="object"||o===null||o.header===void 0)return{result:!1,errorType:"WAIT",errorCode:"",errorMessage:`알 수 없는 오류입니다.
잠시후 다시 시도해 주세요.`};if(o.header.content_update_flag&&o.header.emergency_flag)return{result:!1,errorType:"RESTART",errorCode:"",errorMessage:`컨텐츠가 새 버전으로 변경되었습니다.
확인을 눌러 업데이트를 진행해주세요.`};if(o.header.result===!1)switch(o.header.error_code){case"HE0404":case"HE0503":case"NE0001":case"CE0001":return{result:!1,errorType:"WAIT",errorCode:o.header.error_code,errorMessage:`서버에 연결할 수 없습니다.
(에러 코드: ${o.header.error_code})`};case"NE0002":case"NE0003":return{result:!1,errorType:"WAIT",errorCode:o.header.error_code,errorMessage:`네트워크 상태가 좋지 않습니다.
잠시후 다시 시도해 주세요.
(에러 코드: ${o.header.error_code})`};case"ERR000":return{result:!1,errorType:"RESTART",errorCode:o.header.error_code,errorMessage:`장기간 미사용으로 접속이 끊어졌습니다.
다시 로그인하시기 바랍니다.
(에러 코드: ${o.header.error_code})`};default:return{result:!1,errorType:"WAIT",errorCode:o.header.error_code,errorMessage:`${o.header.error_text||`서버 연결 상태가 좋지 않습니다.
잠시후 다시 시도해 주세요.`}
(에러 코드: ${o.header.error_code})`}}else return{result:!0,errorType:"SUCCESS",errorCode:"",errorMessage:""}}function e(){return{}}function r(){return{}}function t(o="json",c){const n=$(),s={};return c||(o==="json"?(s.Accept="application/json;charset=UTF-8",s["Content-Type"]="application/json;charset=UTF-8"):s.Accept="*/*"),n.accessToken&&(s.Authorization=`Bearer ${n.accessToken}`),s}function T(o,c){const{alert:n}=H();if(c===!1||o.status)return;const s=o.code;let i=null;if(Array.isArray(c)){const h=c.find(g=>typeof g[0]=="string"?g[0]===s:s&&g[0].includes(s));h&&(i=h[1])}else typeof c=="object"&&(i=s?c[s]:null);i||(s==="CM001"?i="조회된 데이터가 없습니다.":s==="DB0001"?i=o.message:i=`네트워크 상태가 좋지 않습니다.
잠시후 다시 시도해 주세요`),typeof i=="string"?n(i):n(i.msg,i.buttonText,i.title)}async function y({isLoading:o=!0,method:c,url:n,body:s,httpHeader:i,errorMessage:h,param:g,retries:b,timeout:C=60,mockJson:w,fileList:m}){var N,x,B,O;const{showLoading:k,removeLoading:f}=I();o&&await k();let a;if(w)n="/admin/mock/"+w+".json?param="+JSON.stringify(Object.assign({},{method:c,url:n,body:s,httpHeader:i,errorMessage:h,param:g,retries:b,timeout:C,fileList:m}));else{if(c==="GET")a=new URLSearchParams(g||{}).toString();else if(m!=null&&m.length){var l=new FormData;l.append("message",JSON.stringify(s??{})),m.forEach(function(F){l.append("fileList",F)}),a=l}else a=s instanceof FormData?s:JSON.stringify(s??{});/(https?:\/\/[^\s]+)/g.test(n)||(n=`http://192.168.3.35:8281/admin/api${n}`)}const u=await q.requestApi({_sMethod:w?"GET":c,_sUrl:c==="GET"||w?n:n+(new URLSearchParams(g||{}).toString()?"?":"")+new URLSearchParams(g||{}).toString(),_oBody:a,_nRetries:b,_nTimeout:C,_oHeader:{...t(a instanceof FormData?"form":"json",!!w),...i}});o&&f();const M={status:!!u.ok&&((N=u==null?void 0:u.data)==null?void 0:N.status),message:((x=u==null?void 0:u.data)==null?void 0:x.message)??"",code:((B=u==null?void 0:u.data)==null?void 0:B.code)??null,data:(O=u==null?void 0:u.data)==null?void 0:O.data};return!(200<=u.status&&u.status<300)&&!M.code&&(M.code="ERR001"),T(M,h),M}return{requestLogin:async({trcode:o,userId:c,password:n,httpHeader:s={},header:i={},body:h={},timeout:g=60,isMock:b=!1,isLoading:C=!0,isErrorAlert:w=!0})=>{const{showLoading:m,removeLoading:k}=I(),{alert:f}=H();C&&await m();const a=await q.requestLogin({_sTrcode:o,_sUserId:c,_sPassword:n,_oHttpHeader:{...e(),...s},_oHeader:{...r(),...i},_oBody:h,_bMock:b,_nTimeout:g,_bProgressEnable:!1});C&&k();const l=d(a);return l.result?{result:l.result,errorCode:l.errorCode,trcode:o,header:a.header,body:a.body}:l.errorType==="RESTART"?(await f(l.errorMessage),v.exit({_sType:"logout"}),{result:l.result,trcode:o,errorCode:l.errorCode,header:a.header,body:a.body}):w?(await f(l.errorMessage),{result:l.result,errorCode:l.errorCode,trcode:o,header:a.header,body:a.body}):{result:l.result,errorCode:l.errorCode,trcode:o,header:a.header,body:a.body}},requestTr:async({trcode:o,httpHeader:c={},header:n={},body:s,fileList:i=[],timeout:h=60,isMock:g=!1,isLoading:b=!0,isErrorAlert:C=!0})=>{const{showLoading:w,removeLoading:m}=I(),{alert:k}=H();b&&await w();const f=await q.requestTr({_sTrcode:o,_oHttpHeader:{...e(),...c},_oHeader:{...r(),...n},_oBody:s??{},_aFileList:i,_bMock:g,_nTimeout:h,_bProgressEnable:!1});b&&m();const a=d(f);return a.result?{result:a.result,errorCode:a.errorCode,trcode:o,header:f.header,body:f.body}:a.errorType==="RESTART"?(await k(a.errorMessage),v.exit({_sType:"logout"}),{result:a.result,trcode:o,errorCode:a.errorCode,header:f.header,body:f.body}):C?(await k(a.errorMessage),{result:a.result,errorCode:a.errorCode,trcode:o,header:f.header,body:f.body}):{result:a.result,errorCode:a.errorCode,trcode:o,header:f.header,body:f.body}},fileDownload:async o=>{const c=$();fetch(o.url,{method:"POST",headers:{Authorization:`Bearer ${c.accessToken}`}}).then(n=>{if(!n.ok)throw new Error("Network response was not ok");return n.blob()}).then(n=>{const s=window.URL.createObjectURL(n),i=document.createElement("a");i.style.display="none",i.href=s,i.download=o.filename,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(s)}).catch(n=>console.error("There was an error!",n))},get:async o=>await y({...o,method:"GET"}),post:async o=>await y({...o,method:"POST"})}}export{H as a,z as b,V as u};
