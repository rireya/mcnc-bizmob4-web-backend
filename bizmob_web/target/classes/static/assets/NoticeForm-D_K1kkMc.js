import{d as ue,ap as T,aq as z,l as g,j as O,s as ne,p as de,n as S,k as re,_ as ce,o as D,c as N,w as n,f as a,a as s,H as A,I as b,aj as R,h as w,U as _,ak as Ce,al as Y,M as X,N as pe,g as G,e as ge,a2 as fe,a3 as me,a4 as ye,ar as be,J as _e}from"./index-C5K_s1wl.js";import{a as he}from"./useNetwork-BBZmMd-V.js";import{P as ve}from"./PeriodDate-Y1bD6Y6f.js";import{a as De}from"./utils-CFlAkpuO.js";import{B as Fe}from"./common-AUcBvRqL.js";import{u as xe}from"./useCommonCode-DIzdSdac.js";const H=5,J=2*1024*1024,Ie=ue({__name:"NoticeForm",props:T({isForDetails:{type:Boolean,required:!0},displayFlag:{type:[String,null],required:!0},title:{type:String,required:!0},content:{type:String,required:!0},postId:{type:String},file:{type:Object,required:!0},pinFlag:{type:String,required:!0},selectedPeriod:{type:Boolean,required:!0},pubStartDate:{type:[String,Date,null],required:!0},pubEndDate:{type:[String,Date,null],required:!0}},{parentCategoryId:{type:[String,null],required:!0},parentCategoryIdModifiers:{},subCategoryId:{type:[String,null],required:!0},subCategoryIdModifiers:{}}),emits:T(["update:displayFlag","update:title","update:content","update:file","update:pinFlag","update:pubStartDate","update:pubEndDate","update:selectedPeriod","afterInit"],["update:parentCategoryId","update:subCategoryId"]),setup(h,{expose:o,emit:c}){const e=h,d=c,r=z(h,"parentCategoryId"),l=z(h,"subCategoryId");let C=!1,m=!1;const{alert:F}=he(),{getBoardCategory:P}=xe(),W=g({get(){return e.selectedPeriod},set(t){d("update:selectedPeriod",t)}}),Z=g({get(){return e.displayFlag},set(t){d("update:displayFlag",t)}}),K=g({get(){return e.title},set(t){d("update:title",t)}}),Q=g({get(){return e.content},set(t){d("update:content",t)}}),$=g({get(){return e.pubStartDate},set(t){d("update:pubStartDate",t)}}),ee=g({get(){return e.pubEndDate},set(t){d("update:pubEndDate",t)}}),te=g({get(){return e.pinFlag==="Y"},set(t){d("update:pinFlag",t?"Y":"N")}});function le(t){return t.fileName!==void 0}const v=O([]),x=g(()=>v.value.map(t=>({text:t.codeName,value:t.codeId}))),y=g(()=>{var u;const t=v.value.find(p=>p.codeId===r.value);return!t||!((u=t.subCommonCodeList)!=null&&u.length)?[]:t.subCommonCodeList.map(p=>({text:p.codeName,value:p.codeId}))}),I=()=>{C=!0,l.value="없음"},k=()=>{m=!0,r.value="없음"},M=async()=>{var u;const t=await P(Fe.NOTICE);t&&(v.value=t.categoryList,await S(),e.isForDetails||(r.value=((u=x.value[0])==null?void 0:u.value)??null))},B=async t=>{var u,p;if(await S(),!!t){if(m=!1,C=!1,l.value&&y.value.findIndex(f=>f.value===l.value)<0){(u=y.value[0])!=null&&u.value?l.value=y.value[0].value:l.value=null;return}l.value||(l.value=((p=y.value[0])==null?void 0:p.value)??null)}},ae=()=>{C=!1};ne(r,()=>{B(r.value)},{immediate:!0});const E=e.file.deleteFiles,i=O(),V=()=>{d("update:file",re({files:e.file.files,deleteFiles:E}))},oe=()=>{i.value&&i.value.click&&i.value.click()},se=()=>{const t=e.file.files;if(!i.value||!i.value.files||!i.value.files.length)return;const u=Array.from(i.value.files);if(t.length+u.length>H){F("이미지는 최대 5개 등록가능합니다.");return}for(const p of u){if(p.size>J){F("파일 1개당 용량 (2MB)이 초과되었습니다.");continue}for(let f=0;f<i.value.files.length;f++)i.value.files.item(f)&&!e.file.files.includes(i.value.files.item(f))&&e.file.files.length<5&&t.push(i.value.files.item(f))}V(),i.value.value=""},ie=t=>{const u=e.file.files;e.file.files[t]instanceof File||E.push(e.file.files[t]),u.splice(t,1),V()},q=async()=>{await Promise.all([M()])},U=()=>({category:m,subCategory:C}),j=async()=>{await S(),!r.value||x.value.findIndex(t=>t.value===r.value)<0?(k(),I()):(!l.value||y.value.findIndex(t=>t.value===l.value)<0)&&I()};o({isCategoryNotExist:U,initCategory:j}),de(()=>{q().then(()=>{d("afterInit"),e.isForDetails||B(r.value)})});const L={props:e,emits:d,parentCategoryId:r,subCategoryId:l,get supCategoryIdNotExist(){return C},set supCategoryIdNotExist(t){C=t},get categoryIdNotExist(){return m},set categoryIdNotExist(t){m=t},alert:F,getBoardCategory:P,MAX_FILE_COUNT:H,MAX_FILE_SIZE:J,selectedPeriod:W,displayFlag:Z,title:K,content:Q,pubStartDate:$,pubEndDate:ee,pinFlag:te,isImageFile:le,categoryList:v,parentCategoryItems:x,subCategoryItems:y,setSupCategoryNotExist:I,setCategoryNotExist:k,getCategorySelection:M,onParentCategoryChange:B,onSubCategoryChange:ae,deleteFiles:E,inputFile:i,emitUpdateFile:V,selectFile:oe,onInputFile:se,onDeleteFile:ie,init:q,isCategoryNotExist:U,initCategory:j,PeriodDate:ve,get toFileSize(){return De}};return Object.defineProperty(L,"__isScriptSetup",{enumerable:!1,value:!0}),L}}),Be={class:"form-table"},Ee=a("colgroup",null,[a("col",{style:{width:"124px"}}),a("col"),a("col",{style:{width:"124px"}}),a("col")],-1),Ve={class:"border-b-sm"},Se=a("th",{class:"border-e-sm text-button font-weight-bold"},"카테고리",-1),Ne={class:"px-4 py-2"},Ae=a("th",{class:"border-e-sm text-button font-weight-bold"},"노출여부",-1),we={class:"px-4 py-2"},Pe={class:"border-b-sm"},ke=a("th",{class:"border-e-sm text-button font-weight-bold"},"제목",-1),Me={class:"px-4 py-2"},qe=a("th",{class:"border-e-sm text-button font-weight-bold"},"게시글ID",-1),Ue={class:"px-4 py-2"},je={class:"border-b-sm"},Le=a("th",{class:"border-e-sm text-button font-weight-bold"},"게시기간",-1),Te={class:"px-4 py-2"},ze=a("th",{class:"border-e-sm text-button font-weight-bold"},"상단고정",-1),Oe={class:"px-4 py-2"},Re={class:"border-b-sm text-button font-weight-bold"},Ye=a("th",{class:"border-e-sm"},"이미지 파일",-1),Xe={class:"px-4 py-2",colspan:"3"},Ge={class:"d-flex align-end ga-6"},He=a("input",{type:"text",hidden:""},null,-1),Je=a("p",null,"최대 5개 가능. 파일 1개당 제한용량 2MB",-1),We={class:"text-subtitle-1 font-weight-bold"},Ze={class:"text-primary"},Ke={class:"d-flex align-center justify-space-between border-dashed border-0 border-b-thin"},Qe={class:"d-flex ga-2 text-body-2"},$e={class:"text-disabled"},et={class:""},tt=a("th",{class:"border-e-sm text-button font-weight-bold"},"답변 내용",-1),lt={class:"px-4 py-2",colspan:"3"};function at(h,o,c,e,d,r){return D(),N(_e,{rounded:"lg",class:"overflow-hidden mt-4"},{default:n(()=>[a("table",Be,[Ee,a("tbody",null,[a("tr",Ve,[Se,a("td",Ne,[s(A,{dense:""},{default:n(()=>[s(b,{cols:"6"},{default:n(()=>[s(R,{items:e.parentCategoryItems,density:"compact","item-title":"text","item-value":"value",modelValue:e.parentCategoryId,"onUpdate:modelValue":[o[0]||(o[0]=l=>e.parentCategoryId=l),e.onParentCategoryChange],"single-line":"",variant:"outlined","hide-details":"",disabled:c.isForDetails,placeholder:"선택"},null,8,["items","modelValue","disabled"])]),_:1}),s(b,{cols:"6"},{selection:n(({item:l})=>[w(_((l==null?void 0:l.text)||"없음"),1)]),default:n(()=>[s(R,{items:e.subCategoryItems,density:"compact","item-title":"text","item-value":"value",modelValue:e.subCategoryId,"onUpdate:modelValue":[o[1]||(o[1]=l=>e.subCategoryId=l),e.onSubCategoryChange],"single-line":"",variant:"outlined","hide-details":"",placeholder:"선택"},null,8,["items","modelValue"])]),_:1})]),_:1})]),Ae,a("td",we,[s(Ce,{inline:"",modelValue:e.displayFlag,"onUpdate:modelValue":o[2]||(o[2]=l=>e.displayFlag=l),"hide-details":"auto"},{default:n(()=>[s(Y,{label:"노출",value:"Y",class:"mr-4"}),s(Y,{label:"미노출",value:"N"})]),_:1},8,["modelValue"])])]),a("tr",Pe,[ke,a("td",Me,[s(X,{variant:"outlined",density:"compact",color:"primary","hide-details":"true",placeholder:"제목을 작성해주세요.",modelValue:e.title,"onUpdate:modelValue":o[3]||(o[3]=l=>e.title=l)},null,8,["modelValue"])]),qe,a("td",Ue,[a("label",null,_(c.postId?c.postId:"등록 후 생성"),1)])]),a("tr",je,[Le,a("td",Te,[s(e.PeriodDate,{"selected-period":e.selectedPeriod,"onUpdate:selectedPeriod":o[4]||(o[4]=l=>e.selectedPeriod=l),"format-date":"yyyy.MM.dd","pub-end-date":e.pubEndDate,"onUpdate:pubEndDate":o[5]||(o[5]=l=>e.pubEndDate=l),"pub-start-date":e.pubStartDate,"onUpdate:pubStartDate":o[6]||(o[6]=l=>e.pubStartDate=l)},null,8,["selected-period","pub-end-date","pub-start-date"])]),ze,a("td",Oe,[s(pe,{modelValue:e.pinFlag,"onUpdate:modelValue":o[7]||(o[7]=l=>e.pinFlag=l),"hide-details":"",label:"상단고정"},null,8,["modelValue"])])]),a("tr",Re,[Ye,a("td",Xe,[s(A,{dense:""},{default:n(()=>[s(b,{cols:"12",md:"8"},{default:n(()=>[a("div",Ge,[s(X,{readonly:"",variant:"outlined",color:"primary","hide-details":"true",placeholder:"파일을 선택하세요.",onClick:e.selectFile}),He,a("input",{accept:".png, .jpg, .jpeg",type:"file",multiple:"",hidden:"",ref:"inputFile",onChange:e.onInputFile},null,544),s(G,{flat:"",color:"grey100",onClick:e.selectFile},{default:n(()=>[w("파일선택")]),_:1}),Je])]),_:1}),s(b,{cols:"12"},{default:n(()=>[a("p",We,[w("이미지 파일 첨부 "),a("span",Ze,_(c.file.files.length)+"개",1)])]),_:1}),c.file&&c.file.files.length?(D(),N(b,{key:0,cols:"12"},{default:n(()=>[s(A,{dense:""},{default:n(()=>[(D(!0),ge(fe,null,me(c.file.files,(l,C)=>(D(),N(b,{cols:"12",md:"8",key:C+(e.isImageFile(l)?l.fileName:l.name),class:"pl-0 px-3"},{default:n(()=>[a("div",Ke,[a("div",Qe,[a("p",null,_(e.isImageFile(l)?l.fileName:l.name),1),a("p",$e,_(e.isImageFile(l)?"":e.toFileSize(l.size||0)),1)]),s(G,{flat:"",onClick:m=>e.onDeleteFile(C),icon:"mdi-close",size:"small"},null,8,["onClick"])])]),_:2},1024))),128))]),_:1})]),_:1})):ye("",!0)]),_:1})])]),a("tr",et,[tt,a("td",lt,[s(be,{placeholder:"내용을 선택하세요.",rows:"10",modelValue:e.content,"onUpdate:modelValue":o[8]||(o[8]=l=>e.content=l),"hide-details":"auto"},null,8,["modelValue"])])])])])]),_:1})}const rt=ce(Ie,[["render",at],["__file","C:/workspace/hiplusWEB/smhiplus-mobile-admin-front/src/components/NoticeForm/NoticeForm.vue"]]);export{rt as N};
